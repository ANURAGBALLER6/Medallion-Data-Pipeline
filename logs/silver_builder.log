2025-08-24 11:14:34,740 - INFO - üöÄ Starting Silver Builder (Bronze ‚Üí Silver)
2025-08-24 11:14:35,329 - WARNING - ‚ö† No valid rows for silver.drivers, skipping insert
2025-08-24 11:14:35,852 - ERROR - ‚ùå Error inserting into silver.vehicles: column "rider_name" of relation "vehicles" does not exist
LINE 1: ...id,driver_id,make,model,year,plate,capacity,color,rider_name...
                                                             ^

2025-08-24 11:14:36,369 - WARNING - ‚ö† No valid rows for silver.riders, skipping insert
2025-08-24 11:14:38,302 - ERROR - ‚ùå Error inserting into silver.trips: insert or update on table "trips" violates foreign key constraint "trips_rider_id_fkey"
DETAIL:  Key (rider_id)=(R0014052) is not present in table "riders".

2025-08-24 11:14:39,088 - ERROR - ‚ùå Error inserting into silver.payments: new row for relation "payments" violates check constraint "payments_status_check"
DETAIL:  Failing row contains (P0000001, T0070812, 2022-06-13, paypal, 92.69, 3.53, captured, AUTH987102, 2025-08-24 00:01:15.815033, 2025-08-24 00:01:15.815033).

2025-08-24 11:14:39,108 - INFO - üéâ Silver layer build completed successfully!
2025-08-24 13:36:23,855 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 13:36:24,428 - INFO - üì• Loaded 50000 rows from bronze.drivers
2025-08-24 13:36:24,764 - INFO - üì• Loaded 50000 rows from bronze.vehicles
2025-08-24 13:36:25,204 - INFO - üì• Loaded 75000 rows from bronze.riders
2025-08-24 13:36:26,727 - INFO - üì• Loaded 75000 rows from bronze.trips
2025-08-24 13:36:27,187 - INFO - üì• Loaded 75000 rows from bronze.payments
2025-08-24 13:36:27,210 - INFO - üöñ Drivers cleaned: 50000 rows
2025-08-24 13:36:27,250 - INFO - üöó Vehicles cleaned: 50000 rows
2025-08-24 13:36:27,280 - INFO - üßç Riders cleaned: 75000 rows
2025-08-24 13:36:27,458 - INFO - üõ∫ Trips cleaned: 75000 rows
2025-08-24 13:36:27,517 - INFO - üí≥ Payments cleaned: 75000 rows
2025-08-24 13:36:27,755 - ERROR - ‚ùå Error writing silver.drivers: column "city" of relation "drivers" does not exist
LINE 1: ...d,driver_name,email,dob,signup_date,driver_rating,city,licen...
                                                             ^

2025-08-24 13:36:27,953 - ERROR - ‚ùå Error writing silver.vehicles: column "registration_date" of relation "vehicles" does not exist
LINE 1: ...id,driver_id,make,model,year,plate,capacity,color,registrati...
                                                             ^

2025-08-24 13:36:28,309 - ERROR - ‚ùå Error writing silver.riders: column "home_city" of relation "riders" does not exist
LINE 1: ...ver.riders (rider_id,rider_name,email,signup_date,home_city,...
                                                             ^

2025-08-24 13:36:28,954 - ERROR - ‚ùå Error writing silver.trips: column "request_ts" of relation "trips" does not exist
LINE 1: ...lver.trips (trip_id,rider_id,driver_id,vehicle_id,request_ts...
                                                             ^

2025-08-24 13:36:29,327 - ERROR - ‚ùå Error writing silver.payments: column "payment_method" of relation "payments" does not exist
LINE 1: ... silver.payments (payment_id,trip_id,payment_date,payment_me...
                                                             ^

2025-08-24 13:36:29,336 - INFO - üéâ Silver build completed successfully
2025-08-24 13:37:43,779 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 13:37:44,399 - INFO - üì• Loaded 50000 rows from bronze.drivers
2025-08-24 13:37:44,693 - INFO - üì• Loaded 50000 rows from bronze.vehicles
2025-08-24 13:37:45,175 - INFO - üì• Loaded 75000 rows from bronze.riders
2025-08-24 13:37:46,665 - INFO - üì• Loaded 75000 rows from bronze.trips
2025-08-24 13:37:47,151 - INFO - üì• Loaded 75000 rows from bronze.payments
2025-08-24 13:37:47,173 - INFO - üöñ Drivers cleaned: 50000 rows
2025-08-24 13:37:47,187 - INFO - üöó Vehicles cleaned: 50000 rows
2025-08-24 13:37:47,214 - INFO - üßç Riders cleaned: 75000 rows
2025-08-24 13:37:47,236 - INFO - üõ∫ Trips cleaned: 75000 rows
2025-08-24 13:37:47,254 - INFO - üí≥ Payments cleaned: 75000 rows
2025-08-24 13:37:53,383 - INFO - ‚úÖ Inserted 50000 rows into silver.drivers
2025-08-24 13:38:00,970 - INFO - ‚úÖ Inserted 50000 rows into silver.vehicles
2025-08-24 13:38:09,187 - INFO - ‚úÖ Inserted 75000 rows into silver.riders
2025-08-24 13:38:23,352 - INFO - ‚úÖ Inserted 75000 rows into silver.trips
2025-08-24 13:38:23,508 - ERROR - ‚ùå Error writing silver.payments: new row for relation "payments" violates check constraint "payments_status_check"
DETAIL:  Failing row contains (P0000098, T0072304, 2024-11-22, null, null, null, refunded, null).

2025-08-24 13:38:23,515 - INFO - üéâ Silver build completed successfully
2025-08-24 13:53:36,076 - INFO - ü•à Starting Silver Build
2025-08-24 14:26:05,960 - INFO - ü•à Starting Silver Build
2025-08-24 14:26:05,974 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 14:26:09,161 - INFO - ‚úÖ drivers.pk_unique passed
2025-08-24 14:49:39,504 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 14:49:39,505 - INFO - Setting up Silver and Audit schemas...
2025-08-24 14:49:39,554 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 14:49:39,554 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 14:49:39,554 - INFO - Creating silver.drivers_base ...
2025-08-24 14:49:39,558 - ERROR - ‚ùå Error creating Silver base tables: (psycopg2.errors.UndefinedFunction) function pg_catalog.btrim(date) does not exist
LINE 9:                         NULLIF(TRIM(dob), '')::DATE AS dob,
                                       ^
HINT:  No function matches the given name and argument types. You might need to add explicit type casts.

[SQL: 
                DROP TABLE IF EXISTS silver.drivers_base;
                CREATE TABLE silver.drivers_base AS
                WITH cleaned AS (
                    SELECT
                        driver_id::BIGINT AS driver_id,
                        TRIM(driver_name) AS driver_name,
                        LOWER(TRIM(email)) AS email,
                        NULLIF(TRIM(dob), '')::DATE AS dob,
                        NULLIF(TRIM(signup_date), '')::DATE AS signup_date,
                        CASE WHEN driver_rating IS NULL THEN NULL
                             WHEN driver_rating::NUMERIC BETWEEN 0 AND 5 THEN driver_rating::NUMERIC
                             ELSE NULL END AS driver_rating,
                        TRIM(city) AS city,
                        TRIM(license_number) AS license_number,
                        CASE WHEN LOWER(COALESCE(is_active::TEXT,'')) IN ('true','1','yes') THEN TRUE
                             WHEN LOWER(COALESCE(is_active::TEXT,'')) IN ('false','0','no') THEN FALSE
                             ELSE NULL END AS is_active,
                        ROW_NUMBER() OVER (PARTITION BY driver_id ORDER BY signup_date DESC NULLS LAST) AS rn
                    FROM bronze.drivers
                    WHERE driver_id IS NOT NULL
                )
                SELECT driver_id, driver_name, email, dob, signup_date, driver_rating,
                       city, license_number, is_active
                FROM cleaned WHERE rn = 1;
            ]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-24 14:55:42,866 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 14:55:42,867 - INFO - Setting up Silver and Audit schemas...
2025-08-24 14:55:42,886 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 14:55:42,887 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 14:55:42,887 - INFO - Creating silver.drivers_base ...
2025-08-24 14:55:42,893 - ERROR - ‚ùå Error creating Silver base tables: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type bigint: "D000001"

[SQL: 
                DROP TABLE IF EXISTS silver.drivers_base;
                CREATE TABLE silver.drivers_base AS
                WITH cleaned AS (
                    SELECT
                        driver_id::BIGINT AS driver_id,
                        TRIM(driver_name::TEXT) AS driver_name,
                        LOWER(TRIM(email::TEXT)) AS email,
                        NULLIF(TRIM(dob::TEXT), '')::DATE AS dob,
                        NULLIF(TRIM(signup_date::TEXT), '')::DATE AS signup_date,
                        CASE WHEN driver_rating IS NULL THEN NULL
                             WHEN driver_rating::NUMERIC BETWEEN 0 AND 5 THEN driver_rating::NUMERIC
                             ELSE NULL END AS driver_rating,
                        TRIM(city::TEXT) AS city,
                        TRIM(license_number::TEXT) AS license_number,
                        CASE WHEN LOWER(COALESCE(is_active::TEXT,'')) IN ('true','1','yes') THEN TRUE
                             WHEN LOWER(COALESCE(is_active::TEXT,'')) IN ('false','0','no') THEN FALSE
                             ELSE NULL END AS is_active,
                        ROW_NUMBER() OVER (PARTITION BY driver_id ORDER BY signup_date DESC NULLS LAST) AS rn
                    FROM bronze.drivers
                    WHERE driver_id IS NOT NULL
                )
                SELECT driver_id, driver_name, email, dob, signup_date, driver_rating,
                       city, license_number, is_active
                FROM cleaned WHERE rn = 1;
            ]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-08-24 14:57:08,342 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 14:57:08,342 - INFO - Setting up Silver and Audit schemas...
2025-08-24 14:57:08,363 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 14:57:08,363 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 14:57:08,363 - INFO - Creating silver.drivers_base ...
2025-08-24 14:57:08,637 - INFO - ‚úÖ silver.drivers_base created with 50,000 rows
2025-08-24 14:57:08,655 - INFO - Creating silver.vehicles_base ...
2025-08-24 14:57:08,660 - ERROR - ‚ùå Error creating Silver base tables: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type bigint: "V000001"

[SQL: 
                DROP TABLE IF EXISTS silver.vehicles_base;
                CREATE TABLE silver.vehicles_base AS
                WITH cleaned AS (
                    SELECT
                        vehicle_id::BIGINT AS vehicle_id,
                        driver_id::BIGINT AS driver_id,
                        INITCAP(TRIM(make::TEXT)) AS make,
                        INITCAP(TRIM(model::TEXT)) AS model,
                        NULLIF(year::TEXT,'')::INT AS year,
                        UPPER(TRIM(plate::TEXT)) AS plate,
                        NULLIF(capacity::TEXT,'')::INT AS capacity,
                        INITCAP(TRIM(color::TEXT)) AS color,
                        NULLIF(TRIM(registration_date::TEXT),'')::DATE AS registration_date,
                        CASE WHEN LOWER(COALESCE(is_active::TEXT,'')) IN ('true','1','yes') THEN TRUE
                             WHEN LOWER(COALESCE(is_active::TEXT,'')) IN ('false','0','no') THEN FALSE
                             ELSE NULL END AS is_active,
                        ROW_NUMBER() OVER (PARTITION BY vehicle_id ORDER BY registration_date DESC NULLS LAST) AS rn
                    FROM bronze.vehicles
                    WHERE vehicle_id IS NOT NULL
                )
                SELECT vehicle_id, driver_id, make, model, year, plate, capacity, color, registration_date, is_active
                FROM cleaned WHERE rn = 1;
            ]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-08-24 14:58:37,747 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 14:58:37,747 - INFO - Setting up Silver and Audit schemas...
2025-08-24 14:58:37,769 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 14:58:37,769 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 14:58:37,769 - INFO - Creating silver.drivers_base ...
2025-08-24 14:58:38,027 - INFO - ‚úÖ silver.drivers_base created with 50,000 rows
2025-08-24 14:58:38,036 - INFO - Creating silver.vehicles_base ...
2025-08-24 14:58:38,299 - INFO - ‚úÖ silver.vehicles_base created with 50,000 rows
2025-08-24 14:58:38,309 - INFO - Creating silver.riders_base ...
2025-08-24 14:58:38,312 - ERROR - ‚ùå Error creating Silver base tables: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type bigint: "R0000001"

[SQL: 
                DROP TABLE IF EXISTS silver.riders_base;
                CREATE TABLE silver.riders_base AS
                WITH cleaned AS (
                    SELECT
                        rider_id::BIGINT AS rider_id,
                        TRIM(rider_name::TEXT) AS rider_name,
                        LOWER(TRIM(email::TEXT)) AS email,
                        NULLIF(TRIM(signup_date::TEXT),'')::DATE AS signup_date,
                        INITCAP(TRIM(home_city::TEXT)) AS home_city,
                        CASE WHEN rider_rating IS NULL THEN NULL
                             WHEN rider_rating::NUMERIC BETWEEN 0 AND 5 THEN rider_rating::NUMERIC
                             ELSE NULL END AS rider_rating,
                        TRIM(default_payment_method::TEXT) AS default_payment_method,
                        CASE WHEN LOWER(COALESCE(is_verified::TEXT,'')) IN ('true','1','yes') THEN TRUE
                             WHEN LOWER(COALESCE(is_verified::TEXT,'')) IN ('false','0','no') THEN FALSE
                             ELSE NULL END AS is_verified,
                        ROW_NUMBER() OVER (PARTITION BY rider_id ORDER BY signup_date DESC NULLS LAST) AS rn
                    FROM bronze.riders
                    WHERE rider_id IS NOT NULL
                )
                SELECT rider_id, rider_name, email, signup_date, home_city, rider_rating,
                       default_payment_method, is_verified
                FROM cleaned WHERE rn = 1;
            ]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-08-24 14:59:25,572 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 14:59:25,572 - INFO - Setting up Silver and Audit schemas...
2025-08-24 14:59:25,594 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 14:59:25,595 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 14:59:25,595 - INFO - Creating silver.drivers_base ...
2025-08-24 14:59:25,872 - INFO - ‚úÖ silver.drivers_base created with 50,000 rows
2025-08-24 14:59:25,881 - INFO - Creating silver.vehicles_base ...
2025-08-24 14:59:26,136 - INFO - ‚úÖ silver.vehicles_base created with 50,000 rows
2025-08-24 14:59:26,144 - INFO - Creating silver.riders_base ...
2025-08-24 14:59:26,508 - INFO - ‚úÖ silver.riders_base created with 75,000 rows
2025-08-24 14:59:26,516 - INFO - Creating silver.trips_base ...
2025-08-24 14:59:26,520 - ERROR - ‚ùå Error creating Silver base tables: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type bigint: "T0000001"

[SQL: 
                DROP TABLE IF EXISTS silver.trips_base;
                CREATE TABLE silver.trips_base AS
                WITH cleaned AS (
                    SELECT
                        trip_id::BIGINT AS trip_id,
                        rider_id::BIGINT AS rider_id,
                        driver_id::BIGINT AS driver_id,
                        vehicle_id::BIGINT AS vehicle_id,
                        NULLIF(TRIM(request_ts::TEXT),'')::TIMESTAMP AS request_ts,
                        NULLIF(TRIM(pickup_ts::TEXT),'')::TIMESTAMP AS pickup_ts,
                        NULLIF(TRIM(dropoff_ts::TEXT),'')::TIMESTAMP AS dropoff_ts,
                        TRIM(pickup_location::TEXT) AS pickup_location,
                        TRIM(drop_location::TEXT) AS drop_location,
                        NULLIF(distance_km::TEXT,'')::NUMERIC AS distance_km,
                        NULLIF(duration_min::TEXT,'')::NUMERIC AS duration_min,
                        NULLIF(wait_time_minutes::TEXT,'')::NUMERIC AS wait_time_minutes,
                        NULLIF(surge_multiplier::TEXT,'')::NUMERIC AS surge_multiplier,
                        NULLIF(base_fare_usd::TEXT,'')::NUMERIC AS base_fare_usd,
                        NULLIF(tax_usd::TEXT,'')::NUMERIC AS tax_usd,
                        NULLIF(tip_usd::TEXT,'')::NUMERIC AS tip_usd,
                        NULLIF(total_fare_usd::TEXT,'')::NUMERIC AS total_fare_usd,
                        INITCAP(TRIM(status::TEXT)) AS status,
                        ROW_NUMBER() OVER (PARTITION BY trip_id ORDER BY request_ts DESC NULLS LAST) AS rn
                    FROM bronze.trips
                    WHERE trip_id IS NOT NULL
                )
                SELECT trip_id, rider_id, driver_id, vehicle_id, request_ts, pickup_ts, dropoff_ts,
                       pickup_location, drop_location, distance_km, duration_min, wait_time_minutes,
                       surge_multiplier, base_fare_usd, tax_usd, tip_usd, total_fare_usd, status
                FROM cleaned WHERE rn = 1;
            ]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-08-24 15:00:37,035 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 15:00:37,035 - INFO - Setting up Silver and Audit schemas...
2025-08-24 15:00:37,059 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 15:00:37,059 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 15:00:37,059 - INFO - Creating silver.drivers_base ...
2025-08-24 15:00:37,303 - INFO - ‚úÖ silver.drivers_base created with 50,000 rows
2025-08-24 15:00:37,312 - INFO - Creating silver.vehicles_base ...
2025-08-24 15:00:37,580 - INFO - ‚úÖ silver.vehicles_base created with 50,000 rows
2025-08-24 15:00:37,591 - INFO - Creating silver.riders_base ...
2025-08-24 15:00:37,959 - INFO - ‚úÖ silver.riders_base created with 75,000 rows
2025-08-24 15:00:37,968 - INFO - Creating silver.trips_base ...
2025-08-24 15:00:38,644 - INFO - ‚úÖ silver.trips_base created with 75,000 rows
2025-08-24 15:00:38,659 - INFO - Creating silver.payments_base ...
2025-08-24 15:00:38,663 - ERROR - ‚ùå Error creating Silver base tables: (psycopg2.errors.InvalidTextRepresentation) invalid input syntax for type bigint: "P0000001"

[SQL: 
                DROP TABLE IF EXISTS silver.payments_base;
                CREATE TABLE silver.payments_base AS
                WITH cleaned AS (
                    SELECT
                        payment_id::BIGINT AS payment_id,
                        trip_id::BIGINT AS trip_id,
                        NULLIF(TRIM(payment_date::TEXT),'')::DATE AS payment_date,
                        TRIM(payment_method::TEXT) AS payment_method,
                        NULLIF(amount_usd::TEXT,'')::NUMERIC AS amount_usd,
                        NULLIF(tip_usd::TEXT,'')::NUMERIC AS tip_usd,
                        INITCAP(TRIM(status::TEXT)) AS status,
                        TRIM(auth_code::TEXT) AS auth_code,
                        ROW_NUMBER() OVER (PARTITION BY payment_id ORDER BY payment_date DESC NULLS LAST) AS rn
                    FROM bronze.payments
                    WHERE payment_id IS NOT NULL
                )
                SELECT payment_id, trip_id, payment_date, payment_method, amount_usd, tip_usd, status, auth_code
                FROM cleaned WHERE rn = 1;
            ]
(Background on this error at: https://sqlalche.me/e/20/9h9h)
2025-08-24 15:01:12,969 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 15:01:12,969 - INFO - Setting up Silver and Audit schemas...
2025-08-24 15:01:12,992 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 15:01:12,992 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 15:01:12,993 - INFO - Creating silver.drivers_base ...
2025-08-24 15:01:13,245 - INFO - ‚úÖ silver.drivers_base created with 50,000 rows
2025-08-24 15:01:13,255 - INFO - Creating silver.vehicles_base ...
2025-08-24 15:01:13,545 - INFO - ‚úÖ silver.vehicles_base created with 50,000 rows
2025-08-24 15:01:13,555 - INFO - Creating silver.riders_base ...
2025-08-24 15:01:13,927 - INFO - ‚úÖ silver.riders_base created with 75,000 rows
2025-08-24 15:01:13,935 - INFO - Creating silver.trips_base ...
2025-08-24 15:01:14,503 - INFO - ‚úÖ silver.trips_base created with 75,000 rows
2025-08-24 15:01:14,512 - INFO - Creating silver.payments_base ...
2025-08-24 15:01:14,859 - INFO - ‚úÖ silver.payments_base created with 75,000 rows
2025-08-24 15:01:14,868 - INFO - ‚úÖ All Silver base tables created
2025-08-24 15:01:14,868 - INFO - Performing deep validation...
2025-08-24 15:01:14,868 - INFO - Validating drivers...
2025-08-24 15:01:15,139 - INFO - Loaded 50,000 rows for validation: silver.drivers_base
2025-08-24 15:01:15,303 - ERROR - Error validating drivers: (psycopg2.errors.DependentObjectsStillExist) cannot drop table silver.drivers because other objects depend on it
DETAIL:  constraint vehicles_driver_id_fkey on table silver.vehicles depends on table silver.drivers
constraint trips_driver_id_fkey on table silver.trips depends on table silver.drivers
HINT:  Use DROP ... CASCADE to drop the dependent objects too.

[SQL: 
DROP TABLE silver.drivers]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-24 15:01:15,303 - INFO - Validating vehicles...
2025-08-24 15:01:15,586 - INFO - Loaded 50,000 rows for validation: silver.vehicles_base
2025-08-24 15:01:15,732 - ERROR - Error validating vehicles: (psycopg2.errors.DependentObjectsStillExist) cannot drop table silver.vehicles because other objects depend on it
DETAIL:  constraint trips_vehicle_id_fkey on table silver.trips depends on table silver.vehicles
HINT:  Use DROP ... CASCADE to drop the dependent objects too.

[SQL: 
DROP TABLE silver.vehicles]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-24 15:01:15,732 - INFO - Validating riders...
2025-08-24 15:01:16,110 - INFO - Loaded 75,000 rows for validation: silver.riders_base
2025-08-24 15:01:16,240 - ERROR - Error validating riders: (psycopg2.errors.DependentObjectsStillExist) cannot drop table silver.riders because other objects depend on it
DETAIL:  constraint trips_rider_id_fkey on table silver.trips depends on table silver.riders
HINT:  Use DROP ... CASCADE to drop the dependent objects too.

[SQL: 
DROP TABLE silver.riders]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-24 15:01:16,240 - INFO - Validating trips...
2025-08-24 15:01:17,579 - INFO - Loaded 75,000 rows for validation: silver.trips_base
2025-08-24 15:01:23,878 - INFO - ‚úÖ 65,994 valid rows saved to silver.trips
2025-08-24 15:01:23,906 - ERROR - Error saving rejected rows for trips: (psycopg2.errors.SyntaxError) syntax error at or near ":"
LINE 3:                             VALUES ('trips', :r::jsonb, 'tot...
                                                     ^

[SQL: 
                            INSERT INTO audit.rejected_rows (table_name, record, reason, run_id)
                            VALUES (%(t)s, :r::jsonb, %(reason)s, %(run)s)
                        ]
[parameters: {'t': 'trips', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_150112'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-24 15:01:23,906 - WARNING - ‚ö†Ô∏è  9,006 invalid rows saved to audit.rejected_rows
2025-08-24 15:01:23,920 - INFO - Validating payments...
2025-08-24 15:01:24,362 - INFO - Loaded 75,000 rows for validation: silver.payments_base
2025-08-24 15:01:24,461 - WARNING - ‚ö†Ô∏è No valid rows to write for payments
2025-08-24 15:01:24,482 - ERROR - Error saving rejected rows for payments: (psycopg2.errors.SyntaxError) syntax error at or near ":"
LINE 3:                             VALUES ('payments', :r::jsonb, '...
                                                        ^

[SQL: 
                            INSERT INTO audit.rejected_rows (table_name, record, reason, run_id)
                            VALUES (%(t)s, :r::jsonb, %(reason)s, %(run)s)
                        ]
[parameters: {'t': 'payments', 'reason': 'Unknown payment_method', 'run': '20250824_150112'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-24 15:01:24,482 - WARNING - ‚ö†Ô∏è  75,000 invalid rows saved to audit.rejected_rows
2025-08-24 15:01:24,489 - WARNING - ‚ö†Ô∏è  Some tables had validation issues
2025-08-24 15:01:24,489 - INFO - Running Data Quality checks...
2025-08-24 15:01:24,489 - INFO - Running DQ checks for drivers...
2025-08-24 15:01:24,503 - INFO - ‚úÖ drivers.pk_uniqueness: PASSED
2025-08-24 15:01:24,601 - WARNING - ‚ùå drivers.email_uniqueness: 41030 bad rows
2025-08-24 15:01:24,602 - INFO - Running DQ checks for vehicles...
2025-08-24 15:01:24,617 - INFO - ‚úÖ vehicles.pk_uniqueness: PASSED
2025-08-24 15:01:24,637 - INFO - ‚úÖ vehicles.fk_driver: PASSED
2025-08-24 15:01:24,637 - INFO - Running DQ checks for riders...
2025-08-24 15:01:24,654 - INFO - ‚úÖ riders.pk_uniqueness: PASSED
2025-08-24 15:01:24,779 - WARNING - ‚ùå riders.email_uniqueness: 66001 bad rows
2025-08-24 15:01:24,780 - INFO - Running DQ checks for trips...
2025-08-24 15:01:24,808 - INFO - ‚úÖ trips.pk_uniqueness: PASSED
2025-08-24 15:01:24,844 - INFO - ‚úÖ trips.fk_rider: PASSED
2025-08-24 15:01:24,874 - INFO - ‚úÖ trips.fk_driver: PASSED
2025-08-24 15:01:24,906 - INFO - ‚úÖ trips.fk_vehicle: PASSED
2025-08-24 15:01:24,907 - INFO - Running DQ checks for payments...
2025-08-24 15:01:25,089 - INFO - ‚úÖ payments.pk_uniqueness: PASSED
2025-08-24 15:01:25,131 - WARNING - ‚ùå payments.fk_trip: 9028 bad rows
2025-08-24 15:01:25,132 - WARNING - ‚ö†Ô∏è  Some Data Quality checks failed ‚Äî see audit.dq_results
2025-08-24 15:01:25,132 - INFO - ============================================================
2025-08-24 15:01:25,132 - INFO - üìä SILVER LAYER PROCESSING SUMMARY
2025-08-24 15:01:25,133 - INFO - ============================================================
2025-08-24 15:01:25,133 - INFO -   drivers   :        0 ‚Üí        0 valid,      0 rejected
2025-08-24 15:01:25,133 - INFO -   vehicles  :        0 ‚Üí        0 valid,      0 rejected
2025-08-24 15:01:25,133 - INFO -   riders    :        0 ‚Üí        0 valid,      0 rejected
2025-08-24 15:01:25,133 - INFO -   trips     :   75,000 ‚Üí   65,994 valid,  9,006 rejected
2025-08-24 15:01:25,133 - INFO -   payments  :   75,000 ‚Üí        0 valid, 75,000 rejected
2025-08-24 15:01:25,133 - INFO - ------------------------------------------------------------
2025-08-24 15:01:25,133 - INFO -   TOTAL     :  150,000 ‚Üí   65,994 valid, 84,006 rejected
2025-08-24 15:01:25,133 - INFO -   Run ID: 20250824_150112
2025-08-24 15:01:25,133 - INFO - ============================================================
2025-08-24 15:01:25,133 - INFO - üéâ Silver build completed
2025-08-24 15:04:12,772 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 15:04:12,772 - INFO - Setting up Silver and Audit schemas...
2025-08-24 15:04:12,793 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 15:04:12,793 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 15:04:12,794 - INFO - Creating silver.drivers_base ...
2025-08-24 15:04:13,067 - INFO - ‚úÖ silver.drivers_base created with 50,000 rows
2025-08-24 15:04:13,076 - INFO - Creating silver.vehicles_base ...
2025-08-24 15:04:13,307 - INFO - ‚úÖ silver.vehicles_base created with 50,000 rows
2025-08-24 15:04:13,316 - INFO - Creating silver.riders_base ...
2025-08-24 15:04:13,664 - INFO - ‚úÖ silver.riders_base created with 75,000 rows
2025-08-24 15:04:13,672 - INFO - Creating silver.trips_base ...
2025-08-24 15:04:14,391 - INFO - ‚úÖ silver.trips_base created with 75,000 rows
2025-08-24 15:04:14,404 - INFO - Creating silver.payments_base ...
2025-08-24 15:04:14,733 - INFO - ‚úÖ silver.payments_base created with 75,000 rows
2025-08-24 15:04:14,743 - INFO - ‚úÖ All Silver base tables created
2025-08-24 15:04:14,743 - INFO - Performing deep validation...
2025-08-24 15:04:14,743 - INFO - Validating drivers...
2025-08-24 15:04:15,013 - INFO - Loaded 50,000 rows for validation: silver.drivers_base
2025-08-24 15:04:15,176 - ERROR - Error validating drivers: (psycopg2.errors.DependentObjectsStillExist) cannot drop table silver.drivers because other objects depend on it
DETAIL:  constraint vehicles_driver_id_fkey on table silver.vehicles depends on table silver.drivers
HINT:  Use DROP ... CASCADE to drop the dependent objects too.

[SQL: 
DROP TABLE silver.drivers]
(Background on this error at: https://sqlalche.me/e/20/2j85)
2025-08-24 15:04:15,176 - INFO - Validating vehicles...
2025-08-24 15:04:15,454 - INFO - Loaded 50,000 rows for validation: silver.vehicles_base
2025-08-24 15:04:17,429 - INFO - ‚úÖ 50,000 valid rows saved to silver.vehicles
2025-08-24 15:04:17,457 - INFO - Validating riders...
2025-08-24 15:04:17,812 - INFO - Loaded 75,000 rows for validation: silver.riders_base
2025-08-24 15:04:20,432 - INFO - ‚úÖ 75,000 valid rows saved to silver.riders
2025-08-24 15:04:20,475 - INFO - Validating trips...
2025-08-24 15:04:21,732 - INFO - Loaded 75,000 rows for validation: silver.trips_base
2025-08-24 15:04:27,830 - INFO - ‚úÖ 65,994 valid rows saved to silver.trips
2025-08-24 15:04:27,878 - ERROR - Error saving rejected rows for trips: (psycopg2.errors.SyntaxError) syntax error at or near ":"
LINE 3:                             VALUES ('trips', :r::jsonb, 'tot...
                                                     ^

[SQL: 
                            INSERT INTO audit.rejected_rows (table_name, record, reason, run_id)
                            VALUES (%(t)s, :r::jsonb, %(reason)s, %(run)s)
                        ]
[parameters: {'t': 'trips', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_150412'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-24 15:04:27,878 - WARNING - ‚ö†Ô∏è  9,006 invalid rows saved to audit.rejected_rows
2025-08-24 15:04:27,896 - INFO - Validating payments...
2025-08-24 15:04:28,376 - INFO - Loaded 75,000 rows for validation: silver.payments_base
2025-08-24 15:04:28,479 - WARNING - ‚ö†Ô∏è No valid rows to write for payments
2025-08-24 15:04:28,500 - ERROR - Error saving rejected rows for payments: (psycopg2.errors.SyntaxError) syntax error at or near ":"
LINE 3:                             VALUES ('payments', :r::jsonb, '...
                                                        ^

[SQL: 
                            INSERT INTO audit.rejected_rows (table_name, record, reason, run_id)
                            VALUES (%(t)s, :r::jsonb, %(reason)s, %(run)s)
                        ]
[parameters: {'t': 'payments', 'reason': 'Unknown payment_method', 'run': '20250824_150412'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-24 15:04:28,500 - WARNING - ‚ö†Ô∏è  75,000 invalid rows saved to audit.rejected_rows
2025-08-24 15:04:28,502 - WARNING - ‚ö†Ô∏è  Some tables had validation issues
2025-08-24 15:04:28,502 - INFO - Running Data Quality checks...
2025-08-24 15:04:28,502 - INFO - Running DQ checks for drivers...
2025-08-24 15:04:28,514 - INFO - ‚úÖ drivers.pk_uniqueness: PASSED
2025-08-24 15:04:28,612 - WARNING - ‚ùå drivers.email_uniqueness: 41030 bad rows
2025-08-24 15:04:28,613 - INFO - Running DQ checks for vehicles...
2025-08-24 15:04:28,721 - INFO - ‚úÖ vehicles.pk_uniqueness: PASSED
2025-08-24 15:04:28,742 - INFO - ‚úÖ vehicles.fk_driver: PASSED
2025-08-24 15:04:28,742 - INFO - Running DQ checks for riders...
2025-08-24 15:04:28,942 - INFO - ‚úÖ riders.pk_uniqueness: PASSED
2025-08-24 15:04:29,068 - WARNING - ‚ùå riders.email_uniqueness: 66001 bad rows
2025-08-24 15:04:29,069 - INFO - Running DQ checks for trips...
2025-08-24 15:04:29,099 - INFO - ‚úÖ trips.pk_uniqueness: PASSED
2025-08-24 15:04:29,137 - INFO - ‚úÖ trips.fk_rider: PASSED
2025-08-24 15:04:29,168 - INFO - ‚úÖ trips.fk_driver: PASSED
2025-08-24 15:04:29,199 - INFO - ‚úÖ trips.fk_vehicle: PASSED
2025-08-24 15:04:29,200 - INFO - Running DQ checks for payments...
2025-08-24 15:04:29,372 - INFO - ‚úÖ payments.pk_uniqueness: PASSED
2025-08-24 15:04:29,407 - WARNING - ‚ùå payments.fk_trip: 9028 bad rows
2025-08-24 15:04:29,413 - WARNING - ‚ö†Ô∏è  Some Data Quality checks failed ‚Äî see audit.dq_results
2025-08-24 15:04:29,413 - INFO - ============================================================
2025-08-24 15:04:29,413 - INFO - üìä SILVER LAYER PROCESSING SUMMARY
2025-08-24 15:04:29,413 - INFO - ============================================================
2025-08-24 15:04:29,413 - INFO -   drivers   :        0 ‚Üí        0 valid,      0 rejected
2025-08-24 15:04:29,413 - INFO -   vehicles  :   50,000 ‚Üí   50,000 valid,      0 rejected
2025-08-24 15:04:29,413 - INFO -   riders    :   75,000 ‚Üí   75,000 valid,      0 rejected
2025-08-24 15:04:29,413 - INFO -   trips     :   75,000 ‚Üí   65,994 valid,  9,006 rejected
2025-08-24 15:04:29,414 - INFO -   payments  :   75,000 ‚Üí        0 valid, 75,000 rejected
2025-08-24 15:04:29,414 - INFO - ------------------------------------------------------------
2025-08-24 15:04:29,414 - INFO -   TOTAL     :  275,000 ‚Üí  190,994 valid, 84,006 rejected
2025-08-24 15:04:29,414 - INFO -   Run ID: 20250824_150412
2025-08-24 15:04:29,414 - INFO - ============================================================
2025-08-24 15:04:29,414 - INFO - üéâ Silver build completed
2025-08-24 15:13:45,746 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 15:13:45,747 - INFO - Setting up Silver and Audit schemas...
2025-08-24 15:13:45,773 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 15:13:45,773 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 15:13:45,773 - INFO - Creating silver.drivers_base ...
2025-08-24 15:13:46,069 - INFO - ‚úÖ silver.drivers_base created with 50,000 rows
2025-08-24 15:13:46,082 - INFO - Creating silver.vehicles_base ...
2025-08-24 15:13:46,388 - INFO - ‚úÖ silver.vehicles_base created with 50,000 rows
2025-08-24 15:13:46,402 - INFO - Creating silver.riders_base ...
2025-08-24 15:13:46,915 - INFO - ‚úÖ silver.riders_base created with 75,000 rows
2025-08-24 15:13:46,925 - INFO - Creating silver.trips_base ...
2025-08-24 15:13:47,631 - INFO - ‚úÖ silver.trips_base created with 75,000 rows
2025-08-24 15:13:47,650 - INFO - Creating silver.payments_base ...
2025-08-24 15:13:48,098 - INFO - ‚úÖ silver.payments_base created with 75,000 rows
2025-08-24 15:13:48,108 - INFO - ‚úÖ All Silver base tables created
2025-08-24 15:13:48,108 - INFO - Performing deep validation...
2025-08-24 15:13:48,108 - INFO - Validating drivers...
2025-08-24 15:13:48,366 - INFO - Loaded 50,000 rows for validation: silver.drivers_base
2025-08-24 15:13:50,893 - INFO - ‚úÖ 50,000 valid rows saved to silver.drivers
2025-08-24 15:13:50,915 - INFO - Validating vehicles...
2025-08-24 15:13:51,110 - INFO - Loaded 50,000 rows for validation: silver.vehicles_base
2025-08-24 15:13:53,076 - INFO - ‚úÖ 50,000 valid rows saved to silver.vehicles
2025-08-24 15:13:53,114 - INFO - Validating riders...
2025-08-24 15:13:53,472 - INFO - Loaded 75,000 rows for validation: silver.riders_base
2025-08-24 15:13:56,240 - INFO - ‚úÖ 75,000 valid rows saved to silver.riders
2025-08-24 15:13:56,271 - INFO - Validating trips...
2025-08-24 15:13:57,592 - INFO - Loaded 75,000 rows for validation: silver.trips_base
2025-08-24 15:14:05,394 - INFO - ‚úÖ 65,994 valid rows saved to silver.trips
2025-08-24 15:14:05,417 - ERROR - Error saving rejected rows for trips: (psycopg2.errors.SyntaxError) syntax error at or near ":"
LINE 3:                             VALUES ('trips', :r::jsonb, 'tot...
                                                     ^

[SQL: 
                            INSERT INTO audit.rejected_rows (table_name, record, reason, run_id)
                            VALUES (%(t)s, :r::jsonb, %(reason)s, %(run)s)
                        ]
[parameters: {'t': 'trips', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_151345'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-24 15:14:05,417 - WARNING - ‚ö†Ô∏è  9,006 invalid rows saved to audit.rejected_rows
2025-08-24 15:14:05,436 - INFO - Validating payments...
2025-08-24 15:14:05,992 - INFO - Loaded 75,000 rows for validation: silver.payments_base
2025-08-24 15:14:06,097 - WARNING - ‚ö†Ô∏è No valid rows to write for payments
2025-08-24 15:14:06,117 - ERROR - Error saving rejected rows for payments: (psycopg2.errors.SyntaxError) syntax error at or near ":"
LINE 3:                             VALUES ('payments', :r::jsonb, '...
                                                        ^

[SQL: 
                            INSERT INTO audit.rejected_rows (table_name, record, reason, run_id)
                            VALUES (%(t)s, :r::jsonb, %(reason)s, %(run)s)
                        ]
[parameters: {'t': 'payments', 'reason': 'Unknown payment_method', 'run': '20250824_151345'}]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-24 15:14:06,117 - WARNING - ‚ö†Ô∏è  75,000 invalid rows saved to audit.rejected_rows
2025-08-24 15:14:06,123 - INFO - ‚úÖ All tables passed deep validation
2025-08-24 15:14:06,123 - INFO - Running Data Quality checks...
2025-08-24 15:14:06,123 - INFO - Running DQ checks for drivers...
2025-08-24 15:14:06,145 - INFO - ‚úÖ drivers.pk_uniqueness: PASSED
2025-08-24 15:14:06,266 - WARNING - ‚ùå drivers.email_uniqueness: 41030 bad rows
2025-08-24 15:14:06,267 - INFO - Running DQ checks for vehicles...
2025-08-24 15:14:06,416 - INFO - ‚úÖ vehicles.pk_uniqueness: PASSED
2025-08-24 15:14:06,439 - INFO - ‚úÖ vehicles.fk_driver: PASSED
2025-08-24 15:14:06,440 - INFO - Running DQ checks for riders...
2025-08-24 15:14:06,689 - INFO - ‚úÖ riders.pk_uniqueness: PASSED
2025-08-24 15:14:06,836 - WARNING - ‚ùå riders.email_uniqueness: 66001 bad rows
2025-08-24 15:14:06,836 - INFO - Running DQ checks for trips...
2025-08-24 15:14:06,869 - INFO - ‚úÖ trips.pk_uniqueness: PASSED
2025-08-24 15:14:06,919 - INFO - ‚úÖ trips.fk_rider: PASSED
2025-08-24 15:14:06,955 - INFO - ‚úÖ trips.fk_driver: PASSED
2025-08-24 15:14:06,990 - INFO - ‚úÖ trips.fk_vehicle: PASSED
2025-08-24 15:14:06,991 - INFO - Running DQ checks for payments...
2025-08-24 15:14:07,218 - INFO - ‚úÖ payments.pk_uniqueness: PASSED
2025-08-24 15:14:07,263 - WARNING - ‚ùå payments.fk_trip: 9028 bad rows
2025-08-24 15:14:07,265 - WARNING - ‚ö†Ô∏è  Some Data Quality checks failed ‚Äî see audit.dq_results
2025-08-24 15:14:07,265 - INFO - ============================================================
2025-08-24 15:14:07,265 - INFO - üìä SILVER LAYER PROCESSING SUMMARY
2025-08-24 15:14:07,265 - INFO - ============================================================
2025-08-24 15:14:07,265 - INFO -   drivers   :   50,000 ‚Üí   50,000 valid,      0 rejected
2025-08-24 15:14:07,265 - INFO -   vehicles  :   50,000 ‚Üí   50,000 valid,      0 rejected
2025-08-24 15:14:07,265 - INFO -   riders    :   75,000 ‚Üí   75,000 valid,      0 rejected
2025-08-24 15:14:07,265 - INFO -   trips     :   75,000 ‚Üí   65,994 valid,  9,006 rejected
2025-08-24 15:14:07,265 - INFO -   payments  :   75,000 ‚Üí        0 valid, 75,000 rejected
2025-08-24 15:14:07,265 - INFO - ------------------------------------------------------------
2025-08-24 15:14:07,266 - INFO -   TOTAL     :  325,000 ‚Üí  240,994 valid, 84,006 rejected
2025-08-24 15:14:07,266 - INFO -   Run ID: 20250824_151345
2025-08-24 15:14:07,266 - INFO - ============================================================
2025-08-24 15:14:07,266 - INFO - üéâ Silver build completed
2025-08-24 15:16:38,249 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 15:16:38,249 - INFO - Setting up Silver and Audit schemas...
2025-08-24 15:16:38,268 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 15:16:38,269 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 15:16:38,269 - INFO - Creating silver.drivers_base ...
2025-08-24 15:16:38,557 - INFO - ‚úÖ silver.drivers_base created with 50,000 rows
2025-08-24 15:16:38,565 - INFO - Creating silver.vehicles_base ...
2025-08-24 15:16:38,804 - INFO - ‚úÖ silver.vehicles_base created with 50,000 rows
2025-08-24 15:16:38,813 - INFO - Creating silver.riders_base ...
2025-08-24 15:16:39,185 - INFO - ‚úÖ silver.riders_base created with 75,000 rows
2025-08-24 15:16:39,195 - INFO - Creating silver.trips_base ...
2025-08-24 15:16:39,804 - INFO - ‚úÖ silver.trips_base created with 75,000 rows
2025-08-24 15:16:39,815 - INFO - Creating silver.payments_base ...
2025-08-24 15:16:40,152 - INFO - ‚úÖ silver.payments_base created with 75,000 rows
2025-08-24 15:16:40,160 - INFO - ‚úÖ All Silver base tables created
2025-08-24 15:16:40,160 - INFO - Performing deep validation...
2025-08-24 15:16:40,160 - INFO - Validating drivers...
2025-08-24 15:16:40,389 - INFO - Loaded 50,000 rows for validation: silver.drivers_base
2025-08-24 15:16:42,363 - INFO - ‚úÖ 50,000 valid rows saved to silver.drivers
2025-08-24 15:16:42,381 - INFO - Validating vehicles...
2025-08-24 15:16:42,550 - INFO - Loaded 50,000 rows for validation: silver.vehicles_base
2025-08-24 15:16:44,321 - INFO - ‚úÖ 50,000 valid rows saved to silver.vehicles
2025-08-24 15:16:44,345 - INFO - Validating riders...
2025-08-24 15:16:44,643 - INFO - Loaded 75,000 rows for validation: silver.riders_base
2025-08-24 15:16:47,111 - INFO - ‚úÖ 75,000 valid rows saved to silver.riders
2025-08-24 15:16:47,154 - INFO - Validating trips...
2025-08-24 15:16:48,294 - INFO - Loaded 75,000 rows for validation: silver.trips_base
2025-08-24 15:16:53,743 - INFO - ‚úÖ 65,994 valid rows saved to silver.trips
2025-08-24 15:16:53,743 - ERROR - Error validating trips: 'SilverBuilder' object has no attribute '_save_rejected_rows'
2025-08-24 15:16:53,771 - INFO - Validating payments...
2025-08-24 15:16:54,129 - INFO - Loaded 75,000 rows for validation: silver.payments_base
2025-08-24 15:16:54,221 - WARNING - ‚ö†Ô∏è No valid rows to write for payments
2025-08-24 15:16:54,221 - ERROR - Error validating payments: 'SilverBuilder' object has no attribute '_save_rejected_rows'
2025-08-24 15:16:54,236 - WARNING - ‚ö†Ô∏è  Some tables had validation issues
2025-08-24 15:16:54,236 - INFO - Running Data Quality checks...
2025-08-24 15:16:54,236 - INFO - Running DQ checks for drivers...
2025-08-24 15:16:54,256 - INFO - ‚úÖ drivers.pk_uniqueness: PASSED
2025-08-24 15:16:54,342 - WARNING - ‚ùå drivers.email_uniqueness: 41030 bad rows
2025-08-24 15:16:54,343 - INFO - Running DQ checks for vehicles...
2025-08-24 15:16:54,451 - INFO - ‚úÖ vehicles.pk_uniqueness: PASSED
2025-08-24 15:16:54,472 - INFO - ‚úÖ vehicles.fk_driver: PASSED
2025-08-24 15:16:54,472 - INFO - Running DQ checks for riders...
2025-08-24 15:16:54,675 - INFO - ‚úÖ riders.pk_uniqueness: PASSED
2025-08-24 15:16:54,801 - WARNING - ‚ùå riders.email_uniqueness: 66001 bad rows
2025-08-24 15:16:54,801 - INFO - Running DQ checks for trips...
2025-08-24 15:16:54,828 - INFO - ‚úÖ trips.pk_uniqueness: PASSED
2025-08-24 15:16:54,865 - INFO - ‚úÖ trips.fk_rider: PASSED
2025-08-24 15:16:54,898 - INFO - ‚úÖ trips.fk_driver: PASSED
2025-08-24 15:16:54,931 - INFO - ‚úÖ trips.fk_vehicle: PASSED
2025-08-24 15:16:54,932 - INFO - Running DQ checks for payments...
2025-08-24 15:16:55,101 - INFO - ‚úÖ payments.pk_uniqueness: PASSED
2025-08-24 15:16:55,143 - WARNING - ‚ùå payments.fk_trip: 9028 bad rows
2025-08-24 15:16:55,144 - WARNING - ‚ö†Ô∏è  Some Data Quality checks failed ‚Äî see audit.dq_results
2025-08-24 15:16:55,144 - INFO - ============================================================
2025-08-24 15:16:55,144 - INFO - üìä SILVER LAYER PROCESSING SUMMARY
2025-08-24 15:16:55,145 - INFO - ============================================================
2025-08-24 15:16:55,145 - INFO -   drivers   :   50,000 ‚Üí   50,000 valid,      0 rejected
2025-08-24 15:16:55,145 - INFO -   vehicles  :   50,000 ‚Üí   50,000 valid,      0 rejected
2025-08-24 15:16:55,145 - INFO -   riders    :   75,000 ‚Üí   75,000 valid,      0 rejected
2025-08-24 15:16:55,145 - INFO -   trips     :        0 ‚Üí        0 valid,      0 rejected
2025-08-24 15:16:55,145 - INFO -   payments  :        0 ‚Üí        0 valid,      0 rejected
2025-08-24 15:16:55,145 - INFO - ------------------------------------------------------------
2025-08-24 15:16:55,145 - INFO -   TOTAL     :  175,000 ‚Üí  175,000 valid,      0 rejected
2025-08-24 15:16:55,145 - INFO -   Run ID: 20250824_151638
2025-08-24 15:16:55,145 - INFO - ============================================================
2025-08-24 15:16:55,145 - INFO - üéâ Silver build completed
2025-08-24 15:24:35,445 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 15:24:35,445 - INFO - Setting up Silver and Audit schemas...
2025-08-24 15:24:35,486 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 15:24:35,486 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 15:24:35,486 - INFO - Creating silver.drivers_base ...
2025-08-24 15:24:36,089 - INFO - ‚úÖ silver.drivers_base created with 50,000 rows
2025-08-24 15:24:36,103 - INFO - Creating silver.vehicles_base ...
2025-08-24 15:24:36,646 - INFO - ‚úÖ silver.vehicles_base created with 50,000 rows
2025-08-24 15:24:36,668 - INFO - Creating silver.riders_base ...
2025-08-24 15:24:37,200 - INFO - ‚úÖ silver.riders_base created with 75,000 rows
2025-08-24 15:24:37,210 - INFO - Creating silver.trips_base ...
2025-08-24 15:24:37,956 - INFO - ‚úÖ silver.trips_base created with 75,000 rows
2025-08-24 15:24:37,969 - INFO - Creating silver.payments_base ...
2025-08-24 15:24:38,358 - INFO - ‚úÖ silver.payments_base created with 75,000 rows
2025-08-24 15:24:38,368 - INFO - ‚úÖ All Silver base tables created
2025-08-24 15:24:38,368 - INFO - Performing deep validation...
2025-08-24 15:24:38,368 - INFO - Validating drivers...
2025-08-24 15:24:38,672 - INFO - Loaded 50,000 rows for validation: silver.drivers_base
2025-08-24 15:24:41,122 - INFO - ‚úÖ 50,000 valid rows saved to silver.drivers
2025-08-24 15:24:41,145 - INFO - Validating vehicles...
2025-08-24 15:24:41,336 - INFO - Loaded 50,000 rows for validation: silver.vehicles_base
2025-08-24 15:24:43,515 - INFO - ‚úÖ 50,000 valid rows saved to silver.vehicles
2025-08-24 15:24:43,542 - INFO - Validating riders...
2025-08-24 15:24:43,860 - INFO - Loaded 75,000 rows for validation: silver.riders_base
2025-08-24 15:24:46,681 - INFO - ‚úÖ 75,000 valid rows saved to silver.riders
2025-08-24 15:24:46,707 - INFO - Validating trips...
2025-08-24 15:24:48,054 - INFO - Loaded 75,000 rows for validation: silver.trips_base
2025-08-24 15:24:54,541 - INFO - ‚úÖ 65,994 valid rows saved to silver.trips
2025-08-24 15:24:54,644 - ERROR - Error saving rejected rows for trips: module 'pandas.io.json' has no attribute 'dumps'
2025-08-24 15:24:54,648 - WARNING - ‚ö†Ô∏è  9,006 invalid rows saved to audit.rejected_rows
2025-08-24 15:24:54,696 - INFO - Validating payments...
2025-08-24 15:24:55,089 - INFO - Loaded 75,000 rows for validation: silver.payments_base
2025-08-24 15:24:57,660 - INFO - ‚úÖ 64,433 valid rows saved to silver.payments
2025-08-24 15:24:57,724 - ERROR - Error saving rejected rows for payments: module 'pandas.io.json' has no attribute 'dumps'
2025-08-24 15:24:57,727 - WARNING - ‚ö†Ô∏è  10,567 invalid rows saved to audit.rejected_rows
2025-08-24 15:24:57,756 - INFO - ‚úÖ All tables passed deep validation
2025-08-24 15:24:57,756 - INFO - Running Data Quality checks...
2025-08-24 15:24:57,756 - INFO - Running DQ checks for drivers...
2025-08-24 15:24:57,778 - INFO - ‚úÖ drivers.pk_uniqueness: PASSED
2025-08-24 15:24:57,875 - WARNING - ‚ùå drivers.email_uniqueness: 41030 bad rows
2025-08-24 15:24:57,876 - INFO - Running DQ checks for vehicles...
2025-08-24 15:24:58,030 - INFO - ‚úÖ vehicles.pk_uniqueness: PASSED
2025-08-24 15:24:58,057 - INFO - ‚úÖ vehicles.fk_driver: PASSED
2025-08-24 15:24:58,058 - INFO - Running DQ checks for riders...
2025-08-24 15:24:58,309 - INFO - ‚úÖ riders.pk_uniqueness: PASSED
2025-08-24 15:24:58,456 - WARNING - ‚ùå riders.email_uniqueness: 66001 bad rows
2025-08-24 15:24:58,457 - INFO - Running DQ checks for trips...
2025-08-24 15:24:58,487 - INFO - ‚úÖ trips.pk_uniqueness: PASSED
2025-08-24 15:24:58,530 - INFO - ‚úÖ trips.fk_rider: PASSED
2025-08-24 15:24:58,567 - INFO - ‚úÖ trips.fk_driver: PASSED
2025-08-24 15:24:58,600 - INFO - ‚úÖ trips.fk_vehicle: PASSED
2025-08-24 15:24:58,601 - INFO - Running DQ checks for payments...
2025-08-24 15:24:58,628 - INFO - ‚úÖ payments.pk_uniqueness: PASSED
2025-08-24 15:24:58,672 - WARNING - ‚ùå payments.fk_trip: 7758 bad rows
2025-08-24 15:24:58,678 - WARNING - ‚ö†Ô∏è  Some Data Quality checks failed ‚Äî see audit.dq_results
2025-08-24 15:24:58,678 - INFO - ============================================================
2025-08-24 15:24:58,678 - INFO - üìä SILVER LAYER PROCESSING SUMMARY
2025-08-24 15:24:58,678 - INFO - ============================================================
2025-08-24 15:24:58,678 - INFO -   drivers   :   50,000 ‚Üí   50,000 valid,      0 rejected
2025-08-24 15:24:58,678 - INFO -   vehicles  :   50,000 ‚Üí   50,000 valid,      0 rejected
2025-08-24 15:24:58,678 - INFO -   riders    :   75,000 ‚Üí   75,000 valid,      0 rejected
2025-08-24 15:24:58,678 - INFO -   trips     :   75,000 ‚Üí   65,994 valid,  9,006 rejected
2025-08-24 15:24:58,678 - INFO -   payments  :   75,000 ‚Üí   64,433 valid, 10,567 rejected
2025-08-24 15:24:58,678 - INFO - ------------------------------------------------------------
2025-08-24 15:24:58,678 - INFO -   TOTAL     :  325,000 ‚Üí  305,427 valid, 19,573 rejected
2025-08-24 15:24:58,678 - INFO -   Run ID: 20250824_152435
2025-08-24 15:24:58,678 - INFO - ============================================================
2025-08-24 15:24:58,678 - INFO - üéâ Silver build completed
2025-08-24 15:39:43,861 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 15:39:43,861 - INFO - Setting up Silver and Audit schemas...
2025-08-24 15:39:43,879 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 15:39:43,880 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 15:39:43,880 - INFO - Creating silver.drivers_base ...
2025-08-24 15:39:44,167 - INFO - ‚úÖ silver.drivers_base created with 50,000 rows
2025-08-24 15:39:44,177 - INFO - Creating silver.vehicles_base ...
2025-08-24 15:39:44,427 - INFO - ‚úÖ silver.vehicles_base created with 50,000 rows
2025-08-24 15:39:44,435 - INFO - Creating silver.riders_base ...
2025-08-24 15:39:44,807 - INFO - ‚úÖ silver.riders_base created with 75,000 rows
2025-08-24 15:39:44,814 - INFO - Creating silver.trips_base ...
2025-08-24 15:39:45,453 - INFO - ‚úÖ silver.trips_base created with 75,000 rows
2025-08-24 15:39:45,465 - INFO - Creating silver.payments_base ...
2025-08-24 15:39:45,882 - INFO - ‚úÖ silver.payments_base created with 75,000 rows
2025-08-24 15:39:45,890 - INFO - ‚úÖ All Silver base tables created
2025-08-24 15:39:45,890 - INFO - Performing deep validation...
2025-08-24 15:39:45,890 - INFO - Validating drivers...
2025-08-24 15:39:46,142 - INFO - Loaded 50,000 rows for validation: silver.drivers_base
2025-08-24 15:39:56,352 - INFO - ‚úÖ 50,000 valid rows saved to silver.drivers
2025-08-24 15:39:56,372 - INFO - Validating vehicles...
2025-08-24 15:39:56,535 - INFO - Loaded 50,000 rows for validation: silver.vehicles_base
2025-08-24 15:40:08,393 - INFO - ‚úÖ 50,000 valid rows saved to silver.vehicles
2025-08-24 15:40:08,416 - INFO - Validating riders...
2025-08-24 15:40:08,724 - INFO - Loaded 75,000 rows for validation: silver.riders_base
2025-08-24 15:40:22,837 - INFO - ‚úÖ 75,000 valid rows saved to silver.riders
2025-08-24 15:40:22,864 - INFO - Validating trips...
2025-08-24 15:40:24,129 - INFO - Loaded 75,000 rows for validation: silver.trips_base
2025-08-24 15:40:52,912 - INFO - ‚úÖ 65,994 valid rows saved to silver.trips
2025-08-24 15:40:53,977 - ERROR - Error saving rejected rows for trips: (psycopg2.errors.UndefinedColumn) column "record" of relation "rejected_rows" does not exist
LINE 2: ...     INSERT INTO audit.rejected_rows (table_name, record, re...
                                                             ^

[SQL: 
                INSERT INTO audit.rejected_rows (table_name, record, reason, run_id)
                VALUES (%(t)s, CAST(%(r)s AS JSONB), %(reason)s, %(run)s)
            ]
[parameters: [{'t': 'trips', 'r': '{"trip_id": "T0000009", "rider_id": "R0022707", "driver_id": "D035187", "vehicle_id": "V035187", "request_ts": "2025-10-17 00:00:00", "pickup_ts": "2 ... (170 characters truncated) ... es": 13.0, "surge_multiplier": 1.12, "base_fare_usd": 18.09, "tax_usd": 1.45, "tip_usd": 2.06, "total_fare_usd": 0.0, "status": "Cancelled_By_Rider"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_153943'}, {'t': 'trips', 'r': '{"trip_id": "T0000014", "rider_id": "R0051880", "driver_id": "D018345", "vehicle_id": "V018345", "request_ts": "2022-09-27 00:00:00", "pickup_ts": "2 ... (173 characters truncated) ... es": 8.0, "surge_multiplier": 1.21, "base_fare_usd": 50.27, "tax_usd": 4.02, "tip_usd": 0.68, "total_fare_usd": 0.0, "status": "Cancelled_By_Driver"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_153943'}, {'t': 'trips', 'r': '{"trip_id": "T0000019", "rider_id": "R0064556", "driver_id": "D025374", "vehicle_id": "V025374", "request_ts": "2021-07-06 00:00:00", "pickup_ts": "2 ... (164 characters truncated) ... it_time_minutes": 1.0, "surge_multiplier": 1.28, "base_fare_usd": 57.54, "tax_usd": 4.6, "tip_usd": 1.33, "total_fare_usd": 0.0, "status": "No_Show"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_153943'}, {'t': 'trips', 'r': '{"trip_id": "T0000028", "rider_id": "R0062058", "driver_id": "D037765", "vehicle_id": "V037765", "request_ts": "2021-11-19 00:00:00", "pickup_ts": "2 ... (172 characters truncated) ... es": 14.0, "surge_multiplier": 1.05, "base_fare_usd": 29.71, "tax_usd": 2.38, "tip_usd": 1.44, "total_fare_usd": 0.0, "status": "Cancelled_By_Rider"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_153943'}, {'t': 'trips', 'r': '{"trip_id": "T0000030", "rider_id": "R0035782", "driver_id": "D002177", "vehicle_id": "V002177", "request_ts": "2020-04-01 00:00:00", "pickup_ts": "2 ... (166 characters truncated) ... t_time_minutes": 3.0, "surge_multiplier": 1.18, "base_fare_usd": 51.17, "tax_usd": 4.09, "tip_usd": 2.35, "total_fare_usd": 0.0, "status": "No_Show"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_153943'}, {'t': 'trips', 'r': '{"trip_id": "T0000038", "rider_id": "R0004849", "driver_id": "D045591", "vehicle_id": "V045591", "request_ts": "2025-08-09 00:00:00", "pickup_ts": "2 ... (176 characters truncated) ... tes": 3.0, "surge_multiplier": 1.29, "base_fare_usd": 29.18, "tax_usd": 2.33, "tip_usd": 2.47, "total_fare_usd": 0.0, "status": "Cancelled_By_Rider"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_153943'}, {'t': 'trips', 'r': '{"trip_id": "T0000044", "rider_id": "R0038828", "driver_id": "D021421", "vehicle_id": "V021421", "request_ts": "2022-08-23 00:00:00", "pickup_ts": "2 ... (177 characters truncated) ... s": 12.0, "surge_multiplier": 1.02, "base_fare_usd": 48.62, "tax_usd": 3.89, "tip_usd": 2.55, "total_fare_usd": 0.0, "status": "Cancelled_By_Driver"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_153943'}, {'t': 'trips', 'r': '{"trip_id": "T0000064", "rider_id": "R0011395", "driver_id": "D018440", "vehicle_id": "V018440", "request_ts": "2023-02-26 00:00:00", "pickup_ts": "2 ... (177 characters truncated) ... s": 12.0, "surge_multiplier": 1.27, "base_fare_usd": 25.88, "tax_usd": 2.07, "tip_usd": 2.54, "total_fare_usd": 0.0, "status": "Cancelled_By_Driver"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_153943'}  ... displaying 10 of 9006 total bound parameter sets ...  {'t': 'trips', 'r': '{"trip_id": "T0074983", "rider_id": "R0027027", "driver_id": "D015454", "vehicle_id": "V015454", "request_ts": "2025-01-17 00:00:00", "pickup_ts": "2 ... (158 characters truncated) ... ait_time_minutes": 6.0, "surge_multiplier": 1.18, "base_fare_usd": 48.4, "tax_usd": 3.87, "tip_usd": 3.1, "total_fare_usd": 0.0, "status": "No_Show"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_153943'}, {'t': 'trips', 'r': '{"trip_id": "T0074985", "rider_id": "R0013207", "driver_id": "D040892", "vehicle_id": "V040892", "request_ts": "2025-05-03 00:00:00", "pickup_ts": "2 ... (173 characters truncated) ... es": 15.0, "surge_multiplier": 1.07, "base_fare_usd": 48.54, "tax_usd": 3.88, "tip_usd": 3.06, "total_fare_usd": 0.0, "status": "Cancelled_By_Rider"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_153943'}]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-24 15:40:53,978 - WARNING - ‚ö†Ô∏è  9,006 invalid rows saved to audit.rejected_rows
2025-08-24 15:40:53,995 - INFO - Validating payments...
2025-08-24 15:40:54,444 - INFO - Loaded 75,000 rows for validation: silver.payments_base
2025-08-24 15:41:06,443 - INFO - ‚úÖ 64,433 valid rows saved to silver.payments
2025-08-24 15:41:07,284 - ERROR - Error saving rejected rows for payments: (psycopg2.errors.UndefinedColumn) column "record" of relation "rejected_rows" does not exist
LINE 2: ...     INSERT INTO audit.rejected_rows (table_name, record, re...
                                                             ^

[SQL: 
                INSERT INTO audit.rejected_rows (table_name, record, reason, run_id)
                VALUES (%(t)s, CAST(%(r)s AS JSONB), %(reason)s, %(run)s)
            ]
[parameters: [{'t': 'payments', 'r': '{"payment_id": "P0000001", "trip_id": "T0070812", "payment_date": "2022-06-13", "payment_method": "Paypal", "amount_usd": 92.69, "tip_usd": 3.53, "status": "Captured", "auth_code": "AUTH987102"}', 'reason': 'Unknown payment_method', 'run': '20250824_153943'}, {'t': 'payments', 'r': '{"payment_id": "P0000002", "trip_id": "T0002979", "payment_date": "2024-06-28", "payment_method": "Paypal", "amount_usd": 94.56, "tip_usd": 0.49, "status": "Captured", "auth_code": "AUTH618060"}', 'reason': 'Unknown payment_method', 'run': '20250824_153943'}, {'t': 'payments', 'r': '{"payment_id": "P0000006", "trip_id": "T0021811", "payment_date": "2022-06-16", "payment_method": "Paypal", "amount_usd": 0.0, "tip_usd": 0.0, "status": "Failed", "auth_code": null}', 'reason': 'Unknown payment_method', 'run': '20250824_153943'}, {'t': 'payments', 'r': '{"payment_id": "P0000015", "trip_id": "T0042367", "payment_date": "2024-10-20", "payment_method": "Paypal", "amount_usd": 40.64, "tip_usd": 1.66, "status": "Captured", "auth_code": "AUTH281090"}', 'reason': 'Unknown payment_method', 'run': '20250824_153943'}, {'t': 'payments', 'r': '{"payment_id": "P0000017", "trip_id": "T0048098", "payment_date": "2025-05-24", "payment_method": "Paypal", "amount_usd": 0.0, "tip_usd": 0.0, "status": "Failed", "auth_code": null}', 'reason': 'Unknown payment_method', 'run': '20250824_153943'}, {'t': 'payments', 'r': '{"payment_id": "P0000029", "trip_id": "T0040782", "payment_date": "2025-08-24", "payment_method": "Paypal", "amount_usd": 71.82, "tip_usd": 3.91, "status": "Captured", "auth_code": "AUTH931907"}', 'reason': 'Unknown payment_method', 'run': '20250824_153943'}, {'t': 'payments', 'r': '{"payment_id": "P0000033", "trip_id": "T0001180", "payment_date": "2021-05-22", "payment_method": "Paypal", "amount_usd": 0.0, "tip_usd": 0.0, "status": "Failed", "auth_code": null}', 'reason': 'Unknown payment_method', 'run': '20250824_153943'}, {'t': 'payments', 'r': '{"payment_id": "P0000037", "trip_id": "T0003688", "payment_date": "2023-08-07", "payment_method": "Paypal", "amount_usd": 0.0, "tip_usd": 0.0, "status": "Failed", "auth_code": null}', 'reason': 'Unknown payment_method', 'run': '20250824_153943'}  ... displaying 10 of 10567 total bound parameter sets ...  {'t': 'payments', 'r': '{"payment_id": "P0074980", "trip_id": "T0037373", "payment_date": "2021-05-08", "payment_method": "Paypal", "amount_usd": 15.68, "tip_usd": 1.6, "status": "Captured", "auth_code": "AUTH378123"}', 'reason': 'Unknown payment_method', 'run': '20250824_153943'}, {'t': 'payments', 'r': '{"payment_id": "P0074992", "trip_id": "T0013477", "payment_date": "2020-04-28", "payment_method": "Paypal", "amount_usd": 99.54, "tip_usd": 2.18, "status": "Captured", "auth_code": "AUTH953889"}', 'reason': 'Unknown payment_method', 'run': '20250824_153943'}]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-24 15:41:07,284 - WARNING - ‚ö†Ô∏è  10,567 invalid rows saved to audit.rejected_rows
2025-08-24 15:41:07,297 - INFO - ‚úÖ All tables passed deep validation
2025-08-24 15:41:07,297 - INFO - Running Data Quality checks...
2025-08-24 15:41:07,297 - INFO - Running DQ checks for drivers...
2025-08-24 15:41:07,315 - INFO - ‚úÖ drivers.pk_uniqueness: PASSED
2025-08-24 15:41:07,398 - WARNING - ‚ùå drivers.email_uniqueness: 41030 bad rows
2025-08-24 15:41:07,399 - INFO - Running DQ checks for vehicles...
2025-08-24 15:41:07,502 - INFO - ‚úÖ vehicles.pk_uniqueness: PASSED
2025-08-24 15:41:07,525 - INFO - ‚úÖ vehicles.fk_driver: PASSED
2025-08-24 15:41:07,526 - INFO - Running DQ checks for riders...
2025-08-24 15:41:07,724 - INFO - ‚úÖ riders.pk_uniqueness: PASSED
2025-08-24 15:41:07,848 - WARNING - ‚ùå riders.email_uniqueness: 66001 bad rows
2025-08-24 15:41:07,868 - INFO - Running DQ checks for trips...
2025-08-24 15:41:07,893 - INFO - ‚úÖ trips.pk_uniqueness: PASSED
2025-08-24 15:41:07,924 - INFO - ‚úÖ trips.fk_rider: PASSED
2025-08-24 15:41:07,950 - INFO - ‚úÖ trips.fk_driver: PASSED
2025-08-24 15:41:07,977 - INFO - ‚úÖ trips.fk_vehicle: PASSED
2025-08-24 15:41:07,978 - INFO - Running DQ checks for payments...
2025-08-24 15:41:08,002 - INFO - ‚úÖ payments.pk_uniqueness: PASSED
2025-08-24 15:41:08,034 - WARNING - ‚ùå payments.fk_trip: 7758 bad rows
2025-08-24 15:41:08,040 - WARNING - ‚ö†Ô∏è  Some Data Quality checks failed ‚Äî see audit.dq_results
2025-08-24 15:41:08,041 - INFO - ============================================================
2025-08-24 15:41:08,041 - INFO - üìä SILVER LAYER PROCESSING SUMMARY
2025-08-24 15:41:08,041 - INFO - ============================================================
2025-08-24 15:41:08,041 - INFO -   drivers   :   50,000 ‚Üí   50,000 valid,      0 rejected
2025-08-24 15:41:08,041 - INFO -   vehicles  :   50,000 ‚Üí   50,000 valid,      0 rejected
2025-08-24 15:41:08,041 - INFO -   riders    :   75,000 ‚Üí   75,000 valid,      0 rejected
2025-08-24 15:41:08,041 - INFO -   trips     :   75,000 ‚Üí   65,994 valid,  9,006 rejected
2025-08-24 15:41:08,041 - INFO -   payments  :   75,000 ‚Üí   64,433 valid, 10,567 rejected
2025-08-24 15:41:08,041 - INFO - ------------------------------------------------------------
2025-08-24 15:41:08,041 - INFO -   TOTAL     :  325,000 ‚Üí  305,427 valid, 19,573 rejected
2025-08-24 15:41:08,042 - INFO -   Run ID: 20250824_153943
2025-08-24 15:41:08,042 - INFO - ============================================================
2025-08-24 15:41:08,042 - INFO - üéâ Silver build completed
2025-08-24 15:42:37,033 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 15:42:37,033 - INFO - Setting up Silver and Audit schemas...
2025-08-24 15:42:37,054 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 15:42:37,054 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 15:42:37,054 - INFO - Creating silver.drivers_base ...
2025-08-24 15:42:37,338 - INFO - ‚úÖ silver.drivers_base created with 50,000 rows
2025-08-24 15:42:37,347 - INFO - Creating silver.vehicles_base ...
2025-08-24 15:42:37,579 - INFO - ‚úÖ silver.vehicles_base created with 50,000 rows
2025-08-24 15:42:37,588 - INFO - Creating silver.riders_base ...
2025-08-24 15:42:37,914 - INFO - ‚úÖ silver.riders_base created with 75,000 rows
2025-08-24 15:42:37,921 - INFO - Creating silver.trips_base ...
2025-08-24 15:42:38,525 - INFO - ‚úÖ silver.trips_base created with 75,000 rows
2025-08-24 15:42:38,537 - INFO - Creating silver.payments_base ...
2025-08-24 15:42:38,900 - INFO - ‚úÖ silver.payments_base created with 75,000 rows
2025-08-24 15:42:38,907 - INFO - ‚úÖ All Silver base tables created
2025-08-24 15:42:38,907 - INFO - Performing deep validation...
2025-08-24 15:42:38,907 - INFO - Validating drivers...
2025-08-24 15:42:39,135 - INFO - Loaded 50,000 rows for validation: silver.drivers_base
2025-08-24 15:42:48,387 - INFO - ‚úÖ 50,000 valid rows saved to silver.drivers
2025-08-24 15:42:48,404 - INFO - Validating vehicles...
2025-08-24 15:42:48,570 - INFO - Loaded 50,000 rows for validation: silver.vehicles_base
2025-08-24 15:42:58,653 - INFO - ‚úÖ 50,000 valid rows saved to silver.vehicles
2025-08-24 15:42:58,674 - INFO - Validating riders...
2025-08-24 15:42:58,963 - INFO - Loaded 75,000 rows for validation: silver.riders_base
2025-08-24 15:43:12,755 - INFO - ‚úÖ 75,000 valid rows saved to silver.riders
2025-08-24 15:43:12,776 - INFO - Validating trips...
2025-08-24 15:43:13,898 - INFO - Loaded 75,000 rows for validation: silver.trips_base
2025-08-24 15:43:39,844 - INFO - ‚úÖ 65,994 valid rows saved to silver.trips
2025-08-24 15:43:40,756 - ERROR - Error saving rejected rows for trips: (psycopg2.errors.UndefinedColumn) column "reason" of relation "rejected_rows" does not exist
LINE 2: ...ERT INTO audit.rejected_rows (table_name, record, reason, ru...
                                                             ^

[SQL: 
                INSERT INTO audit.rejected_rows (table_name, record, reason, run_id)
                VALUES (%(t)s, CAST(%(r)s AS JSONB), %(reason)s, %(run)s)
            ]
[parameters: [{'t': 'trips', 'r': '{"trip_id": "T0000009", "rider_id": "R0022707", "driver_id": "D035187", "vehicle_id": "V035187", "request_ts": "2025-10-17 00:00:00", "pickup_ts": "2 ... (170 characters truncated) ... es": 13.0, "surge_multiplier": 1.12, "base_fare_usd": 18.09, "tax_usd": 1.45, "tip_usd": 2.06, "total_fare_usd": 0.0, "status": "Cancelled_By_Rider"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_154237'}, {'t': 'trips', 'r': '{"trip_id": "T0000014", "rider_id": "R0051880", "driver_id": "D018345", "vehicle_id": "V018345", "request_ts": "2022-09-27 00:00:00", "pickup_ts": "2 ... (173 characters truncated) ... es": 8.0, "surge_multiplier": 1.21, "base_fare_usd": 50.27, "tax_usd": 4.02, "tip_usd": 0.68, "total_fare_usd": 0.0, "status": "Cancelled_By_Driver"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_154237'}, {'t': 'trips', 'r': '{"trip_id": "T0000019", "rider_id": "R0064556", "driver_id": "D025374", "vehicle_id": "V025374", "request_ts": "2021-07-06 00:00:00", "pickup_ts": "2 ... (164 characters truncated) ... it_time_minutes": 1.0, "surge_multiplier": 1.28, "base_fare_usd": 57.54, "tax_usd": 4.6, "tip_usd": 1.33, "total_fare_usd": 0.0, "status": "No_Show"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_154237'}, {'t': 'trips', 'r': '{"trip_id": "T0000028", "rider_id": "R0062058", "driver_id": "D037765", "vehicle_id": "V037765", "request_ts": "2021-11-19 00:00:00", "pickup_ts": "2 ... (172 characters truncated) ... es": 14.0, "surge_multiplier": 1.05, "base_fare_usd": 29.71, "tax_usd": 2.38, "tip_usd": 1.44, "total_fare_usd": 0.0, "status": "Cancelled_By_Rider"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_154237'}, {'t': 'trips', 'r': '{"trip_id": "T0000030", "rider_id": "R0035782", "driver_id": "D002177", "vehicle_id": "V002177", "request_ts": "2020-04-01 00:00:00", "pickup_ts": "2 ... (166 characters truncated) ... t_time_minutes": 3.0, "surge_multiplier": 1.18, "base_fare_usd": 51.17, "tax_usd": 4.09, "tip_usd": 2.35, "total_fare_usd": 0.0, "status": "No_Show"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_154237'}, {'t': 'trips', 'r': '{"trip_id": "T0000038", "rider_id": "R0004849", "driver_id": "D045591", "vehicle_id": "V045591", "request_ts": "2025-08-09 00:00:00", "pickup_ts": "2 ... (176 characters truncated) ... tes": 3.0, "surge_multiplier": 1.29, "base_fare_usd": 29.18, "tax_usd": 2.33, "tip_usd": 2.47, "total_fare_usd": 0.0, "status": "Cancelled_By_Rider"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_154237'}, {'t': 'trips', 'r': '{"trip_id": "T0000044", "rider_id": "R0038828", "driver_id": "D021421", "vehicle_id": "V021421", "request_ts": "2022-08-23 00:00:00", "pickup_ts": "2 ... (177 characters truncated) ... s": 12.0, "surge_multiplier": 1.02, "base_fare_usd": 48.62, "tax_usd": 3.89, "tip_usd": 2.55, "total_fare_usd": 0.0, "status": "Cancelled_By_Driver"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_154237'}, {'t': 'trips', 'r': '{"trip_id": "T0000064", "rider_id": "R0011395", "driver_id": "D018440", "vehicle_id": "V018440", "request_ts": "2023-02-26 00:00:00", "pickup_ts": "2 ... (177 characters truncated) ... s": 12.0, "surge_multiplier": 1.27, "base_fare_usd": 25.88, "tax_usd": 2.07, "tip_usd": 2.54, "total_fare_usd": 0.0, "status": "Cancelled_By_Driver"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_154237'}  ... displaying 10 of 9006 total bound parameter sets ...  {'t': 'trips', 'r': '{"trip_id": "T0074983", "rider_id": "R0027027", "driver_id": "D015454", "vehicle_id": "V015454", "request_ts": "2025-01-17 00:00:00", "pickup_ts": "2 ... (158 characters truncated) ... ait_time_minutes": 6.0, "surge_multiplier": 1.18, "base_fare_usd": 48.4, "tax_usd": 3.87, "tip_usd": 3.1, "total_fare_usd": 0.0, "status": "No_Show"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_154237'}, {'t': 'trips', 'r': '{"trip_id": "T0074985", "rider_id": "R0013207", "driver_id": "D040892", "vehicle_id": "V040892", "request_ts": "2025-05-03 00:00:00", "pickup_ts": "2 ... (173 characters truncated) ... es": 15.0, "surge_multiplier": 1.07, "base_fare_usd": 48.54, "tax_usd": 3.88, "tip_usd": 3.06, "total_fare_usd": 0.0, "status": "Cancelled_By_Rider"}', 'reason': 'total_fare_usd != base+tax+tip', 'run': '20250824_154237'}]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-24 15:43:40,757 - WARNING - ‚ö†Ô∏è  9,006 invalid rows saved to audit.rejected_rows
2025-08-24 15:43:40,767 - INFO - Validating payments...
2025-08-24 15:43:41,129 - INFO - Loaded 75,000 rows for validation: silver.payments_base
2025-08-24 15:43:51,415 - INFO - ‚úÖ 64,433 valid rows saved to silver.payments
2025-08-24 15:43:52,235 - ERROR - Error saving rejected rows for payments: (psycopg2.errors.UndefinedColumn) column "reason" of relation "rejected_rows" does not exist
LINE 2: ...ERT INTO audit.rejected_rows (table_name, record, reason, ru...
                                                             ^

[SQL: 
                INSERT INTO audit.rejected_rows (table_name, record, reason, run_id)
                VALUES (%(t)s, CAST(%(r)s AS JSONB), %(reason)s, %(run)s)
            ]
[parameters: [{'t': 'payments', 'r': '{"payment_id": "P0000001", "trip_id": "T0070812", "payment_date": "2022-06-13", "payment_method": "Paypal", "amount_usd": 92.69, "tip_usd": 3.53, "status": "Captured", "auth_code": "AUTH987102"}', 'reason': 'Unknown payment_method', 'run': '20250824_154237'}, {'t': 'payments', 'r': '{"payment_id": "P0000002", "trip_id": "T0002979", "payment_date": "2024-06-28", "payment_method": "Paypal", "amount_usd": 94.56, "tip_usd": 0.49, "status": "Captured", "auth_code": "AUTH618060"}', 'reason': 'Unknown payment_method', 'run': '20250824_154237'}, {'t': 'payments', 'r': '{"payment_id": "P0000006", "trip_id": "T0021811", "payment_date": "2022-06-16", "payment_method": "Paypal", "amount_usd": 0.0, "tip_usd": 0.0, "status": "Failed", "auth_code": null}', 'reason': 'Unknown payment_method', 'run': '20250824_154237'}, {'t': 'payments', 'r': '{"payment_id": "P0000015", "trip_id": "T0042367", "payment_date": "2024-10-20", "payment_method": "Paypal", "amount_usd": 40.64, "tip_usd": 1.66, "status": "Captured", "auth_code": "AUTH281090"}', 'reason': 'Unknown payment_method', 'run': '20250824_154237'}, {'t': 'payments', 'r': '{"payment_id": "P0000017", "trip_id": "T0048098", "payment_date": "2025-05-24", "payment_method": "Paypal", "amount_usd": 0.0, "tip_usd": 0.0, "status": "Failed", "auth_code": null}', 'reason': 'Unknown payment_method', 'run': '20250824_154237'}, {'t': 'payments', 'r': '{"payment_id": "P0000029", "trip_id": "T0040782", "payment_date": "2025-08-24", "payment_method": "Paypal", "amount_usd": 71.82, "tip_usd": 3.91, "status": "Captured", "auth_code": "AUTH931907"}', 'reason': 'Unknown payment_method', 'run': '20250824_154237'}, {'t': 'payments', 'r': '{"payment_id": "P0000033", "trip_id": "T0001180", "payment_date": "2021-05-22", "payment_method": "Paypal", "amount_usd": 0.0, "tip_usd": 0.0, "status": "Failed", "auth_code": null}', 'reason': 'Unknown payment_method', 'run': '20250824_154237'}, {'t': 'payments', 'r': '{"payment_id": "P0000037", "trip_id": "T0003688", "payment_date": "2023-08-07", "payment_method": "Paypal", "amount_usd": 0.0, "tip_usd": 0.0, "status": "Failed", "auth_code": null}', 'reason': 'Unknown payment_method', 'run': '20250824_154237'}  ... displaying 10 of 10567 total bound parameter sets ...  {'t': 'payments', 'r': '{"payment_id": "P0074980", "trip_id": "T0037373", "payment_date": "2021-05-08", "payment_method": "Paypal", "amount_usd": 15.68, "tip_usd": 1.6, "status": "Captured", "auth_code": "AUTH378123"}', 'reason': 'Unknown payment_method', 'run': '20250824_154237'}, {'t': 'payments', 'r': '{"payment_id": "P0074992", "trip_id": "T0013477", "payment_date": "2020-04-28", "payment_method": "Paypal", "amount_usd": 99.54, "tip_usd": 2.18, "status": "Captured", "auth_code": "AUTH953889"}', 'reason': 'Unknown payment_method', 'run': '20250824_154237'}]]
(Background on this error at: https://sqlalche.me/e/20/f405)
2025-08-24 15:43:52,235 - WARNING - ‚ö†Ô∏è  10,567 invalid rows saved to audit.rejected_rows
2025-08-24 15:43:52,248 - INFO - ‚úÖ All tables passed deep validation
2025-08-24 15:43:52,248 - INFO - Running Data Quality checks...
2025-08-24 15:43:52,248 - INFO - Running DQ checks for drivers...
2025-08-24 15:43:52,268 - INFO - ‚úÖ drivers.pk_uniqueness: PASSED
2025-08-24 15:43:52,357 - WARNING - ‚ùå drivers.email_uniqueness: 41030 bad rows
2025-08-24 15:43:52,358 - INFO - Running DQ checks for vehicles...
2025-08-24 15:43:52,508 - INFO - ‚úÖ vehicles.pk_uniqueness: PASSED
2025-08-24 15:43:52,531 - INFO - ‚úÖ vehicles.fk_driver: PASSED
2025-08-24 15:43:52,532 - INFO - Running DQ checks for riders...
2025-08-24 15:43:52,731 - INFO - ‚úÖ riders.pk_uniqueness: PASSED
2025-08-24 15:43:52,857 - WARNING - ‚ùå riders.email_uniqueness: 66001 bad rows
2025-08-24 15:43:52,877 - INFO - Running DQ checks for trips...
2025-08-24 15:43:52,908 - INFO - ‚úÖ trips.pk_uniqueness: PASSED
2025-08-24 15:43:52,948 - INFO - ‚úÖ trips.fk_rider: PASSED
2025-08-24 15:43:52,987 - INFO - ‚úÖ trips.fk_driver: PASSED
2025-08-24 15:43:53,026 - INFO - ‚úÖ trips.fk_vehicle: PASSED
2025-08-24 15:43:53,027 - INFO - Running DQ checks for payments...
2025-08-24 15:43:53,056 - INFO - ‚úÖ payments.pk_uniqueness: PASSED
2025-08-24 15:43:53,106 - WARNING - ‚ùå payments.fk_trip: 7758 bad rows
2025-08-24 15:43:53,113 - WARNING - ‚ö†Ô∏è  Some Data Quality checks failed ‚Äî see audit.dq_results
2025-08-24 15:43:53,113 - INFO - ============================================================
2025-08-24 15:43:53,113 - INFO - üìä SILVER LAYER PROCESSING SUMMARY
2025-08-24 15:43:53,113 - INFO - ============================================================
2025-08-24 15:43:53,113 - INFO -   drivers   :   50,000 ‚Üí   50,000 valid,      0 rejected
2025-08-24 15:43:53,113 - INFO -   vehicles  :   50,000 ‚Üí   50,000 valid,      0 rejected
2025-08-24 15:43:53,113 - INFO -   riders    :   75,000 ‚Üí   75,000 valid,      0 rejected
2025-08-24 15:43:53,113 - INFO -   trips     :   75,000 ‚Üí   65,994 valid,  9,006 rejected
2025-08-24 15:43:53,113 - INFO -   payments  :   75,000 ‚Üí   64,433 valid, 10,567 rejected
2025-08-24 15:43:53,113 - INFO - ------------------------------------------------------------
2025-08-24 15:43:53,114 - INFO -   TOTAL     :  325,000 ‚Üí  305,427 valid, 19,573 rejected
2025-08-24 15:43:53,114 - INFO -   Run ID: 20250824_154237
2025-08-24 15:43:53,114 - INFO - ============================================================
2025-08-24 15:43:53,114 - INFO - üéâ Silver build completed
2025-08-24 15:45:18,152 - INFO - ü•à MEDALLION SILVER LAYER - BUILDER STARTED
2025-08-24 15:45:18,152 - INFO - Setting up Silver and Audit schemas...
2025-08-24 15:45:18,171 - INFO - ‚úÖ Schemas and audit tables ready
2025-08-24 15:45:18,172 - INFO - Creating Silver base tables with light cleaning...
2025-08-24 15:45:18,172 - INFO - Creating silver.drivers_base ...
2025-08-24 15:45:18,440 - INFO - ‚úÖ silver.drivers_base created with 50,000 rows
2025-08-24 15:45:18,449 - INFO - Creating silver.vehicles_base ...
2025-08-24 15:45:18,694 - INFO - ‚úÖ silver.vehicles_base created with 50,000 rows
2025-08-24 15:45:18,702 - INFO - Creating silver.riders_base ...
2025-08-24 15:45:19,033 - INFO - ‚úÖ silver.riders_base created with 75,000 rows
2025-08-24 15:45:19,040 - INFO - Creating silver.trips_base ...
2025-08-24 15:45:19,669 - INFO - ‚úÖ silver.trips_base created with 75,000 rows
2025-08-24 15:45:19,679 - INFO - Creating silver.payments_base ...
2025-08-24 15:45:20,075 - INFO - ‚úÖ silver.payments_base created with 75,000 rows
2025-08-24 15:45:20,082 - INFO - ‚úÖ All Silver base tables created
2025-08-24 15:45:20,083 - INFO - Performing deep validation...
2025-08-24 15:45:20,083 - INFO - Validating drivers...
2025-08-24 15:45:20,310 - INFO - Loaded 50,000 rows for validation: silver.drivers_base
2025-08-24 15:45:29,744 - INFO - ‚úÖ 50,000 valid rows saved to silver.drivers
2025-08-24 15:45:29,761 - INFO - Validating vehicles...
2025-08-24 15:45:29,906 - INFO - Loaded 50,000 rows for validation: silver.vehicles_base
